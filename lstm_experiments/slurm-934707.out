1
2019-08-10 15:36:11.791890: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-10 15:36:12.412241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:03:00.0
totalMemory: 11.91GiB freeMemory: 11.77GiB
2019-08-10 15:36:12.412284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-08-10 15:36:12.852461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-08-10 15:36:12.852512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-08-10 15:36:12.852521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-08-10 15:36:12.852667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11387 MB memory) -> physical GPU (device: 0, name: TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
trainingdata= BS
BS labels: 1=fake, 0=real
train seq shape (14733, 100)
(14733, 2)
Parameters:: num_cells: 64 num_samples: 14733 embedding_size: 300 epochs: 10 batch_size: 64
(?, 100)
fitting model..
Epoch 1/10
 - 58s - loss: 0.6119 - acc: 0.6409
Epoch 2/10
 - 56s - loss: 0.5111 - acc: 0.7453
Epoch 3/10
 - 56s - loss: 0.4248 - acc: 0.8023
Epoch 4/10
 - 56s - loss: 0.3553 - acc: 0.8448
Epoch 5/10
 - 56s - loss: 0.2859 - acc: 0.8805
Epoch 6/10
 - 56s - loss: 0.2446 - acc: 0.8986
Epoch 7/10
 - 55s - loss: 0.1900 - acc: 0.9274
Epoch 8/10
 - 56s - loss: 0.1526 - acc: 0.9418
Epoch 9/10
 - 56s - loss: 0.1215 - acc: 0.9540
Epoch 10/10
 - 56s - loss: 0.0927 - acc: 0.9662
Using TensorFlow backend.
[nltk_data] Downloading package punkt to /home/ktj250/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Testing...
Test loss: 0.4097190323731464
Test accuracy: 0.8859032658123192
tn, fp, fn, tp
2896 332 496 3533
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           (None, 100)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 100, 300)          15512400  
_________________________________________________________________
bidirectional_1 (Bidirection (None, 128)               186880    
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 258       
=================================================================
Total params: 15,699,538
Trainable params: 15,699,538
Non-trainable params: 0
_________________________________________________________________
Testing on kaggle
Kaggle labels: 
 1: unreliable, 0: reliable
accuracy: 0.7202734839476813
tn, fp, fn, tp
1854 1535 347 2992
Testing on FNC
FNC labels: 
 1: Fake, 0: Reliable
accuracy: 0.48
tn, fp, fn, tp
1374 6803 1777 6546
Testing on BS
BS labels: 1=fake, 0=real
accuracy: 0.8859032658123192
tn, fp, fn, tp
2896 332 496 3533
2019-08-10 15:51:50.220505: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-10 15:51:50.866159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:03:00.0
totalMemory: 11.91GiB freeMemory: 11.77GiB
2019-08-10 15:51:50.866203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-08-10 15:51:51.312843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-08-10 15:51:51.312893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-08-10 15:51:51.312900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-08-10 15:51:51.313050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11387 MB memory) -> physical GPU (device: 0, name: TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
trainingdata= liar
Training with Fake= 1
Training with Fake= 1
Training with Fake= 1
train seq shape (10240, 100)
(10240, 2)
Parameters:: num_cells: 64 num_samples: 10240 embedding_size: 300 epochs: 10 batch_size: 64
(?, 100)
fitting model..
Train on 10240 samples, validate on 1284 samples
Epoch 1/10
 - 43s - loss: 0.6858 - acc: 0.5504 - val_loss: 0.6790 - val_acc: 0.5607
Epoch 2/10
 - 41s - loss: 0.6719 - acc: 0.5829 - val_loss: 0.6667 - val_acc: 0.5935
Epoch 3/10
 - 41s - loss: 0.6573 - acc: 0.6135 - val_loss: 0.6545 - val_acc: 0.6246
Epoch 4/10
 - 41s - loss: 0.6399 - acc: 0.6314 - val_loss: 0.6507 - val_acc: 0.6316
Epoch 5/10
 - 41s - loss: 0.6214 - acc: 0.6573 - val_loss: 0.6563 - val_acc: 0.6347
Epoch 6/10
 - 41s - loss: 0.5999 - acc: 0.6802 - val_loss: 0.6598 - val_acc: 0.6355
Epoch 7/10
 - 41s - loss: 0.5727 - acc: 0.7013 - val_loss: 0.6800 - val_acc: 0.6340
Epoch 8/10
 - 41s - loss: 0.5421 - acc: 0.7332 - val_loss: 0.7016 - val_acc: 0.6277
Epoch 9/10
 - 41s - loss: 0.5121 - acc: 0.7474 - val_loss: 0.7308 - val_acc: 0.6238
Epoch 10/10
 - 41s - loss: 0.4796 - acc: 0.7759 - val_loss: 0.7553 - val_acc: 0.6246
Using TensorFlow backend.
[nltk_data] Downloading package punkt to /home/ktj250/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Testing...
Test loss: 0.7533611901745424
Test accuracy: 0.614048935337714
Valid loss: 0.7553177314383961
Valid accuracy: 0.6246105919003115
tn, fp, fn, tp
532 182 307 246
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           (None, 100)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 100, 300)          4084500   
_________________________________________________________________
bidirectional_1 (Bidirection (None, 128)               186880    
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 258       
=================================================================
Total params: 4,271,638
Trainable params: 4,271,638
Non-trainable params: 0
_________________________________________________________________
Testing on kaggle
Kaggle labels: 
 1: unreliable, 0: reliable
accuracy: 0.5732758620689655
tn, fp, fn, tp
2605 784 2087 1252
Testing on FNC
FNC labels: 
 1: Fake, 0: Reliable
accuracy: 0.49448484848484847
tn, fp, fn, tp
5075 3102 5239 3084
Testing on BS
BS labels: 1=fake, 0=real
accuracy: 0.5295576684580405
tn, fp, fn, tp
2552 676 2738 1291
2019-08-10 16:06:49.351930: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-10 16:06:49.978581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:03:00.0
totalMemory: 11.91GiB freeMemory: 11.77GiB
2019-08-10 16:06:49.978623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-08-10 16:06:50.422188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-08-10 16:06:50.422239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-08-10 16:06:50.422247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-08-10 16:06:50.422398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11387 MB memory) -> physical GPU (device: 0, name: TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
trainingdata= kaggle
Kaggle labels: 
 1: unreliable, 0: reliable
train seq shape (13659, 100)
(13659, 2)
Parameters:: num_cells: 64 num_samples: 13659 embedding_size: 300 epochs: 10 batch_size: 64
(?, 100)
fitting model..
Epoch 1/10
 - 57s - loss: 0.5100 - acc: 0.7367
Epoch 2/10
 - 54s - loss: 0.2782 - acc: 0.8864
Epoch 3/10
 - 54s - loss: 0.1933 - acc: 0.9237
Epoch 4/10
 - 54s - loss: 0.1413 - acc: 0.9447
Epoch 5/10
 - 54s - loss: 0.1092 - acc: 0.9576
Epoch 6/10
 - 54s - loss: 0.0843 - acc: 0.9683
Epoch 7/10
 - 54s - loss: 0.0612 - acc: 0.9778
Epoch 8/10
 - 54s - loss: 0.0463 - acc: 0.9839
Epoch 9/10
 - 54s - loss: 0.0354 - acc: 0.9868
Epoch 10/10
 - 54s - loss: 0.0305 - acc: 0.9897
Using TensorFlow backend.
[nltk_data] Downloading package punkt to /home/ktj250/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Testing...
Test loss: 0.14110253292897784
Test accuracy: 0.9637336504161712
tn, fp, fn, tp
3299 90 154 3185
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           (None, 100)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 100, 300)          55647600  
_________________________________________________________________
bidirectional_1 (Bidirection (None, 128)               186880    
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 258       
=================================================================
Total params: 55,834,738
Trainable params: 55,834,738
Non-trainable params: 0
_________________________________________________________________
Testing on kaggle
Kaggle labels: 
 1: unreliable, 0: reliable
accuracy: 0.9637336504161712
tn, fp, fn, tp
3299 90 154 3185
Testing on FNC
FNC labels: 
 1: Fake, 0: Reliable
accuracy: 0.5622424242424242
tn, fp, fn, tp
1082 7095 128 8195
Testing on BS
BS labels: 1=fake, 0=real
accuracy: 0.7526526112718754
tn, fp, fn, tp
2696 532 1263 2766
2019-08-10 16:27:39.376586: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-10 16:27:40.001211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:03:00.0
totalMemory: 11.91GiB freeMemory: 11.77GiB
2019-08-10 16:27:40.001257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-08-10 16:27:40.411492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-08-10 16:27:40.411541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-08-10 16:27:40.411549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-08-10 16:27:40.411699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11387 MB memory) -> physical GPU (device: 0, name: TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
trainingdata= FNC
FNC labels: 
 1: Fake, 0: Reliable
train seq shape (33500, 100)
(33500, 2)
Parameters:: num_cells: 64 num_samples: 33500 embedding_size: 300 epochs: 10 batch_size: 64
(?, 100)
fitting model..
Epoch 1/10
 - 135s - loss: 0.2162 - acc: 0.9028
Epoch 2/10
 - 132s - loss: 0.0684 - acc: 0.9770
Epoch 3/10
 - 132s - loss: 0.0495 - acc: 0.9830
Epoch 4/10
 - 132s - loss: 0.0345 - acc: 0.9877
Epoch 5/10
 - 132s - loss: 0.0224 - acc: 0.9918
Epoch 6/10
 - 132s - loss: 0.0164 - acc: 0.9942
Epoch 7/10
 - 132s - loss: 0.0120 - acc: 0.9958
Epoch 8/10
 - 132s - loss: 0.0084 - acc: 0.9970
Epoch 9/10
 - 132s - loss: 0.0060 - acc: 0.9978
Epoch 10/10
 - 132s - loss: 0.0044 - acc: 0.9985
Using TensorFlow backend.
[nltk_data] Downloading package punkt to /home/ktj250/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Testing...
Test loss: 0.05481123547006494
Test accuracy: 0.9894545454545455
tn, fp, fn, tp
8153 24 150 8173
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           (None, 100)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 100, 300)          72433200  
_________________________________________________________________
bidirectional_1 (Bidirection (None, 128)               186880    
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 258       
=================================================================
Total params: 72,620,338
Trainable params: 72,620,338
Non-trainable params: 0
_________________________________________________________________
Testing on kaggle
Kaggle labels: 
 1: unreliable, 0: reliable
accuracy: 0.6331747919143876
tn, fp, fn, tp
2905 484 1984 1355
Testing on FNC
FNC labels: 
 1: Fake, 0: Reliable
accuracy: 0.9894545454545455
tn, fp, fn, tp
8153 24 150 8173
Testing on BS
BS labels: 1=fake, 0=real
accuracy: 0.49290340361030727
tn, fp, fn, tp
2989 239 3441 588
