0,1,2,3
2019-04-06 12:14:01.909386: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-04-06 12:14:03.746057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:18:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2019-04-06 12:14:03.860120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 1 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:3b:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2019-04-06 12:14:03.991079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 2 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:86:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2019-04-06 12:14:04.113682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 3 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:af:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2019-04-06 12:14:04.130889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0, 1, 2, 3
2019-04-06 12:14:10.988826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-04-06 12:14:10.988878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 1 2 3 
2019-04-06 12:14:10.988887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N Y Y Y 
2019-04-06 12:14:10.988894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 1:   Y N Y Y 
2019-04-06 12:14:10.988900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 2:   Y Y N Y 
2019-04-06 12:14:10.988906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 3:   Y Y Y N 
2019-04-06 12:14:10.990445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11378 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
2019-04-06 12:14:10.991192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11378 MB memory) -> physical GPU (device: 1, name: TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
2019-04-06 12:14:10.991745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 11378 MB memory) -> physical GPU (device: 2, name: TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
2019-04-06 12:14:10.991892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 11378 MB memory) -> physical GPU (device: 3, name: TITAN Xp, pci bus id: 0000:af:00.0, compute capability: 6.1)
[['hey', 'whats', 'up', 'beautiful', 'isnt', 'it', 'lovely', 'houses'], ['wow', 'such', 'spirit', 'and', 'fruitfulness', 'in', 'the', 'apples']]
2019-04-06 12:11:51.444109
train seq shape (13637, 400)
Parameters:: num_cells: 50 num_samples: 13637 embedding_size: 10 epochs: 50 batch_size: 64
(?, 400)
(?, 400, 10)
(?, ?, 50)
predictions_shape: (?, 400, 1)
fitting model..
Train on 10909 samples, validate on 2728 samples
Epoch 1/50
 - 142s - loss: 0.5329 - acc: 0.7515 - val_loss: 0.3490 - val_acc: 0.8919
Epoch 2/50
 - 136s - loss: 0.3665 - acc: 0.8828 - val_loss: 0.3503 - val_acc: 0.8895
Epoch 3/50
 - 136s - loss: 0.3192 - acc: 0.9042 - val_loss: 0.3408 - val_acc: 0.8933
Epoch 4/50
 - 136s - loss: 0.3068 - acc: 0.9057 - val_loss: 0.3475 - val_acc: 0.8947
Epoch 5/50
 - 136s - loss: 0.2633 - acc: 0.9259 - val_loss: 0.3464 - val_acc: 0.8903
Epoch 6/50
 - 136s - loss: 0.2431 - acc: 0.9321 - val_loss: 0.3303 - val_acc: 0.8966
Epoch 7/50
 - 135s - loss: 0.2210 - acc: 0.9396 - val_loss: 0.3444 - val_acc: 0.8958
Epoch 8/50
 - 135s - loss: 0.1997 - acc: 0.9455 - val_loss: 0.3305 - val_acc: 0.8945
Epoch 9/50
 - 135s - loss: 0.1787 - acc: 0.9471 - val_loss: 0.2804 - val_acc: 0.8887
Epoch 10/50
 - 135s - loss: 0.1508 - acc: 0.9520 - val_loss: 0.2310 - val_acc: 0.8824
Epoch 11/50
 - 134s - loss: 0.1543 - acc: 0.9533 - val_loss: 0.2526 - val_acc: 0.8958
Epoch 12/50
 - 135s - loss: 0.1318 - acc: 0.9555 - val_loss: 0.2585 - val_acc: 0.9161
Epoch 13/50
 - 134s - loss: 0.1211 - acc: 0.9577 - val_loss: 0.2237 - val_acc: 0.9214
Epoch 14/50
 - 134s - loss: 0.0999 - acc: 0.9677 - val_loss: 0.2704 - val_acc: 0.9331
Epoch 15/50
 - 134s - loss: 0.1001 - acc: 0.9691 - val_loss: 0.2416 - val_acc: 0.9313
Epoch 16/50
 - 134s - loss: 0.0979 - acc: 0.9689 - val_loss: 0.2345 - val_acc: 0.9361
Epoch 17/50
 - 134s - loss: 0.0932 - acc: 0.9725 - val_loss: 0.2747 - val_acc: 0.9183
Epoch 18/50
 - 133s - loss: 0.0855 - acc: 0.9740 - val_loss: 0.2821 - val_acc: 0.9248
Epoch 19/50
 - 133s - loss: 0.0837 - acc: 0.9758 - val_loss: 0.2857 - val_acc: 0.9275
Epoch 20/50
 - 133s - loss: 0.0749 - acc: 0.9762 - val_loss: 0.2832 - val_acc: 0.9294
Epoch 21/50
 - 133s - loss: 0.0551 - acc: 0.9837 - val_loss: 0.3364 - val_acc: 0.9273
Epoch 22/50
 - 133s - loss: 0.0585 - acc: 0.9822 - val_loss: 0.3320 - val_acc: 0.9302
Epoch 23/50
 - 133s - loss: 0.0543 - acc: 0.9834 - val_loss: 0.2898 - val_acc: 0.9287
Epoch 24/50
 - 133s - loss: 0.0495 - acc: 0.9852 - val_loss: 0.3368 - val_acc: 0.9306
Epoch 25/50
 - 133s - loss: 0.0506 - acc: 0.9847 - val_loss: 0.2755 - val_acc: 0.9322
Epoch 26/50
 - 133s - loss: 0.0448 - acc: 0.9866 - val_loss: 0.3279 - val_acc: 0.9329
Epoch 27/50
 - 133s - loss: 0.0415 - acc: 0.9876 - val_loss: 0.3475 - val_acc: 0.9290
Epoch 28/50
 - 133s - loss: 0.0385 - acc: 0.9891 - val_loss: 0.3317 - val_acc: 0.9304
Epoch 29/50
 - 133s - loss: 0.0461 - acc: 0.9860 - val_loss: 0.2925 - val_acc: 0.9307
Epoch 30/50
 - 133s - loss: 0.0310 - acc: 0.9912 - val_loss: 0.3546 - val_acc: 0.9323
Epoch 31/50
 - 133s - loss: 0.0346 - acc: 0.9889 - val_loss: 0.3672 - val_acc: 0.9289
Epoch 32/50
 - 133s - loss: 0.0324 - acc: 0.9894 - val_loss: 0.3283 - val_acc: 0.9312
Epoch 33/50
 - 133s - loss: 0.0279 - acc: 0.9919 - val_loss: 0.3704 - val_acc: 0.9292
Epoch 34/50
 - 133s - loss: 0.0254 - acc: 0.9924 - val_loss: 0.3614 - val_acc: 0.9313
Epoch 35/50
 - 133s - loss: 0.0271 - acc: 0.9921 - val_loss: 0.2664 - val_acc: 0.9351
Epoch 36/50
 - 133s - loss: 0.0307 - acc: 0.9904 - val_loss: 0.3527 - val_acc: 0.9292
Epoch 37/50
 - 133s - loss: 0.0328 - acc: 0.9902 - val_loss: 0.3278 - val_acc: 0.9347
Epoch 38/50
 - 133s - loss: 0.0258 - acc: 0.9920 - val_loss: 0.3503 - val_acc: 0.9325
Epoch 39/50
 - 133s - loss: 0.0246 - acc: 0.9925 - val_loss: 0.3187 - val_acc: 0.9383
Epoch 40/50
 - 133s - loss: 0.0243 - acc: 0.9929 - val_loss: 0.3202 - val_acc: 0.9374
Epoch 41/50
 - 133s - loss: 0.0186 - acc: 0.9941 - val_loss: 0.3322 - val_acc: 0.9368
Epoch 42/50
 - 133s - loss: 0.0190 - acc: 0.9943 - val_loss: 0.2705 - val_acc: 0.9437
Epoch 43/50
 - 133s - loss: 0.0249 - acc: 0.9922 - val_loss: 0.2246 - val_acc: 0.9466
Epoch 44/50
 - 133s - loss: 0.0235 - acc: 0.9929 - val_loss: 0.2969 - val_acc: 0.9413
Epoch 45/50
 - 133s - loss: 0.0193 - acc: 0.9943 - val_loss: 0.3085 - val_acc: 0.9401
Epoch 46/50
 - 133s - loss: 0.0145 - acc: 0.9956 - val_loss: 0.2935 - val_acc: 0.9434
Epoch 47/50
 - 133s - loss: 0.0113 - acc: 0.9961 - val_loss: 0.3068 - val_acc: 0.9420
Epoch 48/50
 - 133s - loss: 0.0118 - acc: 0.9964 - val_loss: 0.3060 - val_acc: 0.9424
Epoch 49/50
 - 133s - loss: 0.0114 - acc: 0.9961 - val_loss: 0.3152 - val_acc: 0.9394
Epoch 50/50
 - 133s - loss: 0.0155 - acc: 0.9947 - val_loss: 0.3032 - val_acc: 0.9412
Using TensorFlow backend.
Testing...
Test loss: 0.32752569298830797
Test accuracy: 0.9373265861861583
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           (None, 400)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 400, 10)           1859160   
_________________________________________________________________
lstm_1 (LSTM)                (None, 400, 50)           12200     
_________________________________________________________________
time_distributed_1 (TimeDist (None, 400, 1)            51        
=================================================================
Total params: 1,871,411
Trainable params: 1,871,411
Non-trainable params: 0
_________________________________________________________________
