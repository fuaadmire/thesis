0,1,2,3
2019-04-05 22:03:30.083196: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-04-05 22:03:31.932495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:18:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2019-04-05 22:03:32.054069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 1 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:3b:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2019-04-05 22:03:32.180424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 2 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:86:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2019-04-05 22:03:32.319665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 3 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:af:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2019-04-05 22:03:32.334446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0, 1, 2, 3
2019-04-05 22:03:39.015185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-04-05 22:03:39.015233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 1 2 3 
2019-04-05 22:03:39.015243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N Y Y Y 
2019-04-05 22:03:39.015250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 1:   Y N Y Y 
2019-04-05 22:03:39.015256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 2:   Y Y N Y 
2019-04-05 22:03:39.015263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 3:   Y Y Y N 
2019-04-05 22:03:39.016871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11378 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
2019-04-05 22:03:39.017553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11378 MB memory) -> physical GPU (device: 1, name: TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
2019-04-05 22:03:39.017707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 11378 MB memory) -> physical GPU (device: 2, name: TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
2019-04-05 22:03:39.018258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 11378 MB memory) -> physical GPU (device: 3, name: TITAN Xp, pci bus id: 0000:af:00.0, compute capability: 6.1)
2019-04-05 22:00:58.293765
train seq shape (13637, 400)
Parameters:: num_cells: 50 num_samples: 13637 embedding_size: 10 epochs: 40 batch_size: 64
(?, 400)
(?, 400, 10)
(?, ?, 50)
predictions_shape: (?, 400, 1)
fitting model..
Train on 10909 samples, validate on 2728 samples
Epoch 1/40
 - 140s - loss: 0.6845 - acc: 0.5419 - val_loss: 0.6702 - val_acc: 0.5601
Epoch 2/40
 - 133s - loss: 0.6275 - acc: 0.6249 - val_loss: 0.5692 - val_acc: 0.6865
Epoch 3/40
 - 133s - loss: 0.6154 - acc: 0.6389 - val_loss: 0.5721 - val_acc: 0.6851
Epoch 4/40
 - 133s - loss: 0.6068 - acc: 0.6484 - val_loss: 0.5708 - val_acc: 0.6894
Epoch 5/40
 - 133s - loss: 0.6232 - acc: 0.6535 - val_loss: 0.5936 - val_acc: 0.6760
Epoch 6/40
 - 133s - loss: 0.6007 - acc: 0.6724 - val_loss: 0.5677 - val_acc: 0.7026
Epoch 7/40
 - 133s - loss: 0.6116 - acc: 0.6769 - val_loss: 0.5661 - val_acc: 0.7075
Epoch 8/40
 - 133s - loss: 0.6050 - acc: 0.6710 - val_loss: 0.5823 - val_acc: 0.7132
Epoch 9/40
 - 133s - loss: 0.6192 - acc: 0.6754 - val_loss: 0.5695 - val_acc: 0.7135
Epoch 10/40
 - 132s - loss: 0.6005 - acc: 0.6649 - val_loss: 0.5701 - val_acc: 0.6953
Epoch 11/40
 - 133s - loss: 0.5893 - acc: 0.6709 - val_loss: 0.5661 - val_acc: 0.6957
Epoch 12/40
 - 132s - loss: 0.5903 - acc: 0.6712 - val_loss: 0.5639 - val_acc: 0.6956
Epoch 13/40
 - 132s - loss: 0.5879 - acc: 0.6718 - val_loss: 0.5635 - val_acc: 0.6946
Epoch 14/40
 - 132s - loss: 0.5881 - acc: 0.6751 - val_loss: 0.5696 - val_acc: 0.6974
Epoch 15/40
 - 131s - loss: 0.5870 - acc: 0.6774 - val_loss: 0.5612 - val_acc: 0.6965
Epoch 16/40
 - 131s - loss: 0.5890 - acc: 0.6716 - val_loss: 0.5681 - val_acc: 0.6982
Epoch 17/40
 - 131s - loss: 0.5843 - acc: 0.6820 - val_loss: 0.5601 - val_acc: 0.6975
Epoch 18/40
 - 131s - loss: 0.5804 - acc: 0.6820 - val_loss: 0.5548 - val_acc: 0.7053
Epoch 19/40
 - 132s - loss: 0.5814 - acc: 0.6862 - val_loss: 0.5545 - val_acc: 0.7062
Epoch 20/40
 - 132s - loss: 0.5835 - acc: 0.6825 - val_loss: 0.5626 - val_acc: 0.6900
Epoch 21/40
 - 132s - loss: 0.5813 - acc: 0.6773 - val_loss: 0.5516 - val_acc: 0.7062
Epoch 22/40
 - 131s - loss: 0.5837 - acc: 0.6794 - val_loss: 0.5582 - val_acc: 0.7002
Epoch 23/40
 - 130s - loss: 0.5790 - acc: 0.6877 - val_loss: 0.5532 - val_acc: 0.7067
Epoch 24/40
 - 130s - loss: 0.5755 - acc: 0.6914 - val_loss: 0.5556 - val_acc: 0.7114
Epoch 25/40
 - 130s - loss: 0.5795 - acc: 0.6903 - val_loss: 0.5562 - val_acc: 0.7025
Epoch 26/40
 - 130s - loss: 0.5735 - acc: 0.6867 - val_loss: 0.5573 - val_acc: 0.7080
Epoch 27/40
 - 130s - loss: 0.5798 - acc: 0.6813 - val_loss: 0.5538 - val_acc: 0.7045
Epoch 28/40
 - 130s - loss: 0.5790 - acc: 0.6832 - val_loss: 0.5508 - val_acc: 0.7055
Epoch 29/40
 - 130s - loss: 0.5762 - acc: 0.6856 - val_loss: 0.5514 - val_acc: 0.7060
Epoch 30/40
 - 130s - loss: 0.5804 - acc: 0.6891 - val_loss: 0.5570 - val_acc: 0.7103
Epoch 31/40
 - 130s - loss: 0.5755 - acc: 0.6860 - val_loss: 0.5523 - val_acc: 0.7060
Epoch 32/40
 - 130s - loss: 0.5817 - acc: 0.6766 - val_loss: 0.5928 - val_acc: 0.6522
Epoch 33/40
 - 130s - loss: 0.5930 - acc: 0.6548 - val_loss: 0.5774 - val_acc: 0.6675
Epoch 34/40
 - 130s - loss: 0.5870 - acc: 0.6639 - val_loss: 0.5551 - val_acc: 0.6964
Epoch 35/40
 - 130s - loss: 0.5805 - acc: 0.6823 - val_loss: 0.5518 - val_acc: 0.7048
Epoch 36/40
 - 130s - loss: 0.5815 - acc: 0.6741 - val_loss: 0.5499 - val_acc: 0.7017
Epoch 37/40
 - 130s - loss: 0.5805 - acc: 0.6723 - val_loss: 0.5541 - val_acc: 0.6973
Epoch 38/40
 - 130s - loss: 0.5785 - acc: 0.6771 - val_loss: 0.5501 - val_acc: 0.7058
Epoch 39/40
 - 130s - loss: 0.5762 - acc: 0.6814 - val_loss: 0.5481 - val_acc: 0.7080
Epoch 40/40
 - 130s - loss: 0.5762 - acc: 0.6828 - val_loss: 0.5629 - val_acc: 0.7077
Using TensorFlow backend.
Testing...
Test loss: 0.567733960887725
Test accuracy: 0.7048693820989427
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           (None, 400)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 400, 10)           7000      
_________________________________________________________________
lstm_1 (LSTM)                (None, 400, 50)           12200     
_________________________________________________________________
time_distributed_1 (TimeDist (None, 400, 1)            51        
=================================================================
Total params: 19,251
Trainable params: 19,251
Non-trainable params: 0
_________________________________________________________________
